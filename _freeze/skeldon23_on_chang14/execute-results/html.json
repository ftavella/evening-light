{
  "hash": "1e0e1ae6f6c722ed6dc8de08724cb099",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: Skeldon23 model on Chang14 light schedule\nformat:\n  html:\n    code-fold: true\nexecute:\n  freeze: auto\n---\n\n\n\n\n\nWe did simulations for 125 parameter sets:\n\n::: {#ca3d6113 .cell execution_count=3}\n``` {.python .cell-code code-fold=\"false\"}\nmu_values = np.linspace(17.5, 19.5, 5)\ndelta_values = np.linspace(5.0, 9.0, 5)\nchi_values = np.linspace(7.0, 11.0, 5)\n```\n:::\n\n\nwe select only those with a sleep duration that is greater than 6.5 hours, leaving us with 61 parameter sets. The distribution of sleep duration is shown below:\n\n::: {#35126889 .cell execution_count=4}\n\n::: {.cell-output .cell-output-display}\n![](skeldon23_on_chang14_files/figure-html/cell-5-output-1.png){width=581 height=429}\n:::\n:::\n\n\nFor each of these parameter sets, we simulate the model under three light schedules:\n\n- Regular\n- Chang14 with eBook on the first week (book on the second week)\n- Chang14 with eBook on the second week (book on the first week)\n\n\n\nWe can analyze the sleep onset for each simulation condition:\n\n::: {#5226b5c4 .cell execution_count=6}\n\n::: {.cell-output .cell-output-display}\n![](skeldon23_on_chang14_files/figure-html/cell-7-output-1.png){width=495 height=490}\n:::\n:::\n\n\n::: {#ce72ac9a .cell execution_count=7}\n\n::: {.cell-output .cell-output-display}\n![](skeldon23_on_chang14_files/figure-html/cell-8-output-1.png){width=487 height=490}\n:::\n:::\n\n\n::: {#69ecb91d .cell execution_count=8}\n\n::: {.cell-output .cell-output-display}\n![](skeldon23_on_chang14_files/figure-html/cell-9-output-1.png){width=495 height=490}\n:::\n:::\n\n\nAs expected the regular condition has no change in sleep onset across days (it does between different simulations). For the Chang14 light schedule, we see that the sleep onset varies over the two weeks. When the eBook is on the first week (days 2-6), sleep onset remains relatively constant for that first week. However when reading is done with a book (days 8-12), the sleep onset starts to decrease. On the contrary, when the eBook is on the second week, sleep onset starts to decrease at first (book reading), and then increases (eBook reading).\n\nThere are many parameter sets that have a regular sleep onset that is close or equal to 22 hours (time the lights go off). Those  sets tend to have little to no change when simulated under the Chang14 light schedules:\n\n::: {#933b917f .cell execution_count=9}\n\n::: {.cell-output .cell-output-display}\n![](skeldon23_on_chang14_files/figure-html/cell-10-output-1.png){width=597 height=429}\n:::\n:::\n\n\n# Difference in sleep onset between book and ebook days\n\nAs in [@chang_evening_2015], we plot the sleep latency (`sleep_onset - 22.0`) for each reading condition on the last day of reading:\n\n::: {#e1a63e1f .cell execution_count=10}\n\n::: {.cell-output .cell-output-display}\n![](skeldon23_on_chang14_files/figure-html/cell-11-output-1.png){width=585 height=411}\n:::\n:::\n\n\nAdditionally, we calculate the sleep onset difference (within each simulation) between the last day of each reading condition:\n\n::: {#dda35589 .cell execution_count=11}\n\n::: {.cell-output .cell-output-display}\n![](skeldon23_on_chang14_files/figure-html/cell-12-output-1.png){width=585 height=393}\n:::\n:::\n\n\n# Phase shift between book and ebook days\n\nLet's check how different the circadian state is for the different schedules on day 6 (plotting all simulated parameter sets):\n\n::: {#f371a077 .cell execution_count=12}\n\n::: {.cell-output .cell-output-display}\n![](skeldon23_on_chang14_files/figure-html/cell-13-output-1.png){width=605 height=449}\n:::\n:::\n\n\nIt is surprising that there isn't a spread between circadian states for different parameter sets, they are all on top of each other. On the other hand, if we plot the sleep pressure, we see a spread consistent with the spread in sleep onset times:\n\n::: {#ef00caf1 .cell execution_count=13}\n\n::: {.cell-output .cell-output-display}\n![](skeldon23_on_chang14_files/figure-html/cell-14-output-1.png){width=589 height=449}\n:::\n:::\n\n\nWhy is this the case?\n\nI think the reason is because of the way the sleep homeostat is implemented. The only way that the sleep homeostat can affect the circadian state is by switching to sleep at a moment when the light is greater than zero. If this happens, the input light to the circadian model goes to zero. However, in these simulations we are forcing the model to be awake when the light is on, so the light schedule is the same for all simulations. This means that the circadian state is the same for all simulations. \n\nThe only thing that can change the circadian state is changing the schedule, which does affect the final result as seen on the circadian state plot.\n\nTherefore we can only obtain two values for the phase shift between book and eBook days, one for each schedule:\n\n::: {#54eeac00 .cell execution_count=14}\n\n::: {.cell-output .cell-output-display}\n![](skeldon23_on_chang14_files/figure-html/cell-15-output-1.png){width=605 height=449}\n:::\n\n::: {.cell-output .cell-output-display}\n![](skeldon23_on_chang14_files/figure-html/cell-15-output-2.png){width=605 height=449}\n:::\n:::\n\n\nThe phase shift (calculated as the CBTmin difference between each condition) is 44\\.40 min for the eBook first condition and 14\\.40 min for the eBook second condition.\n\nLet's check if this is true for all parameter sets:\n\n::: {#8ccd534f .cell execution_count=15}\n\n::: {.cell-output .cell-output-stdout}\n```\nCondition: ebook_first\nCBTmin time day 6:\n[3.33  3.33  3.33  3.33  3.335 3.335 3.33  3.335 3.33  3.33  3.33  3.33\n 3.33  3.335 3.33  3.335 3.335 3.335 3.33  3.335 3.335 3.335 3.33  3.33\n 3.33  3.33  3.33  3.33  3.335 3.33  3.33  3.335 3.335 3.33  3.33  3.335\n 3.335 3.335 3.33  3.335 3.33  3.33  3.33  3.33  3.33  3.33  3.335 3.33\n 3.33  3.33  3.335 3.335 3.33  3.33  3.335 3.335 3.335 3.33  3.335 3.335\n 3.335]\nCBTmin time day 12:\n[2.59 2.59 2.59 2.59 2.59 2.59 2.59 2.59 2.59 2.59 2.59 2.59 2.59 2.59\n 2.59 2.59 2.59 2.59 2.59 2.59 2.59 2.59 2.59 2.59 2.59 2.59 2.59 2.59\n 2.59 2.59 2.59 2.59 2.59 2.59 2.59 2.59 2.59 2.59 2.59 2.59 2.59 2.59\n 2.59 2.59 2.59 2.59 2.59 2.59 2.59 2.59 2.59 2.59 2.59 2.59 2.59 2.59\n 2.59 2.59 2.59 2.59 2.59]\nCondition: ebook_second\nCBTmin time day 6:\n[2.71 2.71 2.71 2.71 2.71 2.71 2.71 2.71 2.71 2.71 2.71 2.71 2.71 2.71\n 2.71 2.71 2.71 2.71 2.71 2.71 2.71 2.71 2.71 2.71 2.71 2.71 2.71 2.71\n 2.71 2.71 2.71 2.71 2.71 2.71 2.71 2.71 2.71 2.71 2.71 2.71 2.71 2.71\n 2.71 2.71 2.71 2.71 2.71 2.71 2.71 2.71 2.71 2.71 2.71 2.71 2.71 2.71\n 2.71 2.71 2.71 2.71 2.71]\nCBTmin time day 12:\n[2.95 2.95 2.95 2.95 2.95 2.95 2.95 2.95 2.95 2.95 2.95 2.95 2.95 2.95\n 2.95 2.95 2.95 2.95 2.95 2.95 2.95 2.95 2.95 2.95 2.95 2.95 2.95 2.95\n 2.95 2.95 2.95 2.95 2.95 2.95 2.95 2.95 2.95 2.95 2.95 2.95 2.95 2.95\n 2.95 2.95 2.95 2.95 2.95 2.95 2.95 2.95 2.95 2.95 2.95 2.95 2.95 2.95\n 2.95 2.95 2.95 2.95 2.95]\n```\n:::\n:::\n\n\nwe can see that except for small differences (0.005, equal to `dt`), they all have the same values.\n\n",
    "supporting": [
      "skeldon23_on_chang14_files\\figure-html"
    ],
    "filters": [],
    "includes": {}
  }
}